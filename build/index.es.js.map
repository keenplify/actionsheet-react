{"version":3,"file":"index.es.js","sources":["../src/index.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport {\r\n  ReactNode,\r\n  useState,\r\n  useRef,\r\n  useEffect,\r\n  useImperativeHandle,\r\n  Fragment,\r\n} from \"react\";\r\n\r\nexport interface ActionSheetProps {\r\n  onClose?: () => void;\r\n  children?: ReactNode;\r\n  bgStyle?: React.CSSProperties;\r\n  sheetStyle?: React.CSSProperties;\r\n  mouseEnable?: boolean;\r\n  touchEnable?: boolean;\r\n  threshold?: number;\r\n  opacity?: number;\r\n  zIndex?: number;\r\n  closeOnBgTap?: boolean;\r\n  bgTransition?: string;\r\n  className?: string;\r\n  sheetTransition?: string;\r\n  reverse?: boolean;\r\n}\r\n\r\nexport interface ActionSheetRef {\r\n  open(): void;\r\n  close(): void;\r\n}\r\n\r\nconst ActionSheet = React.forwardRef<\r\n  ActionSheetRef | undefined,\r\n  ActionSheetProps\r\n>(\r\n  (\r\n    {\r\n      onClose,\r\n      children,\r\n      sheetStyle,\r\n      bgStyle,\r\n      mouseEnable = true,\r\n      touchEnable = true,\r\n      threshold = 50,\r\n      opacity = 1,\r\n      zIndex = 998,\r\n      closeOnBgTap = true,\r\n      bgTransition = \"opacity 0.5s ease-in-out, z-index 0.5s ease-in-out\",\r\n      className = \"action-sheet\",\r\n      sheetTransition = \"transform 0.5s linear\",\r\n      reverse = false,\r\n    },\r\n    ref\r\n  ): JSX.Element => {\r\n    const [show, setShow] = useState(false);\r\n    const pressed = useRef(false);\r\n    const sheetRef = useRef<HTMLDivElement>(null);\r\n    const animationRef = useRef(0);\r\n    const masterOffset = useRef(0);\r\n    const startY = useRef(0);\r\n\r\n    useImperativeHandle(ref, () => ({\r\n      open(): void {\r\n        setShow(true);\r\n      },\r\n      close(): void {\r\n        setShow(false);\r\n      },\r\n    }));\r\n\r\n    const BgClick = (): void => {\r\n      setShow(false);\r\n      if (onClose) onClose();\r\n    };\r\n\r\n    const requestSheetDown = React.useCallback((): boolean => {\r\n      if (null !== sheetRef.current) {\r\n        sheetRef.current.style.transition = sheetTransition;\r\n        sheetRef.current.style.transform = reverse\r\n          ? \"translate3d(0, -101%, 0)\"\r\n          : \"translate3d(0, 101%, 0)\";\r\n        return true;\r\n      }\r\n      return false;\r\n    }, [reverse, sheetTransition]);\r\n\r\n    const requestSheetUp = React.useCallback((): boolean => {\r\n      if (null !== sheetRef.current) {\r\n        sheetRef.current.style.transform = `translate3d(0, 0%, 0)`;\r\n        return true;\r\n      }\r\n      return false;\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n      if (show) {\r\n        requestSheetUp();\r\n      } else {\r\n        requestSheetDown();\r\n      }\r\n    }, [requestSheetDown, requestSheetUp, show]);\r\n\r\n    const onSwipeMove = (event: React.TouchEvent<HTMLDivElement>): void => {\r\n      if (pressed.current) {\r\n        const offset = event.touches[0].clientY - startY.current;\r\n        move(offset);\r\n      }\r\n    };\r\n\r\n    const onMouseMove = (\r\n      event: React.MouseEvent<HTMLDivElement, MouseEvent>\r\n    ): void => {\r\n      event.stopPropagation();\r\n      if (pressed.current) {\r\n        if (reverse) {\r\n          const offset = event.clientY - startY.current;\r\n          move(offset);\r\n        } else {\r\n          const offset = event.clientY - startY.current;\r\n          move(offset);\r\n        }\r\n      }\r\n    };\r\n\r\n    const move = (offset: number): boolean => {\r\n      if (!reverse && offset > 0) {\r\n        masterOffset.current = offset;\r\n        animationRef.current = requestAnimationFrame(updatePosition);\r\n        return true;\r\n      } else if (reverse && offset < 0) {\r\n        masterOffset.current = offset;\r\n        animationRef.current = requestAnimationFrame(updatePosition);\r\n        return true;\r\n      }\r\n      return false;\r\n    };\r\n\r\n    const updatePosition = (): boolean => {\r\n      if (animationRef.current !== undefined) {\r\n        if (null !== sheetRef.current) {\r\n          sheetRef.current.style.transform = `translate3d(0, ${masterOffset.current}px, 0)`;\r\n          return true;\r\n        }\r\n        return false;\r\n      }\r\n      return false;\r\n    };\r\n\r\n    const onSwipeStart = (event: React.TouchEvent<HTMLDivElement>): void => {\r\n      if (sheetRef?.current) sheetRef.current.style.transition = \"none\";\r\n      startY.current = event.touches[0].clientY;\r\n      changePressed(true);\r\n    };\r\n\r\n    const onMouseStart = (\r\n      event: React.MouseEvent<HTMLDivElement, MouseEvent>\r\n    ): void => {\r\n      if (sheetRef?.current) sheetRef.current.style.transition = \"none\";\r\n      startY.current = event.clientY;\r\n      changePressed(true);\r\n    };\r\n\r\n    const changePressed = (x: boolean): void => {\r\n      pressed.current = x;\r\n    };\r\n\r\n    const onSwipeEnd = (): void => {\r\n      cancelAnimationFrame(animationRef.current);\r\n      changePressed(false);\r\n      if (Math.abs(masterOffset.current) > threshold) {\r\n        setShow(false);\r\n        if (onClose) onClose();\r\n      } else {\r\n        requestSheetUp();\r\n      }\r\n      masterOffset.current = 0;\r\n    };\r\n\r\n    return (\r\n      <Fragment>\r\n        <div\r\n          onClick={closeOnBgTap ? BgClick : undefined}\r\n          className={className}\r\n          style={{\r\n            position: \"fixed\",\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            backgroundColor: \"rgba(0, 0, 0, 0.8)\",\r\n            backfaceVisibility: \"hidden\",\r\n            transition: bgTransition,\r\n            opacity: show ? opacity : 0,\r\n            zIndex: show ? zIndex : -1,\r\n            ...bgStyle,\r\n          }}\r\n        ></div>\r\n        <div\r\n          ref={sheetRef}\r\n          style={{\r\n            overflowX: \"hidden\",\r\n            position: \"fixed\",\r\n            ...(reverse\r\n              ? {\r\n                  top: 0,\r\n                  transform: \"translate3d(0, -101%, 0)\",\r\n                  borderBottomLeftRadius: 16,\r\n                  borderBottomRightRadius: 16,\r\n                }\r\n              : {\r\n                  bottom: 0,\r\n                  transform: \"translate3d(0, 101%, 0)\",\r\n                  borderTopLeftRadius: 16,\r\n                  borderTopRightRadius: 16,\r\n                }),\r\n            left: 0,\r\n            width: \"100%\",\r\n            backgroundColor: \"#fbfbfb\",\r\n            borderTopLeftRadius: 16,\r\n            borderTopRightRadius: 16,\r\n            touchAction: \"none\",\r\n            zIndex: zIndex + 1,\r\n            ...sheetStyle,\r\n          }}\r\n          onMouseDown={mouseEnable ? onMouseStart : () => undefined}\r\n          onMouseMove={mouseEnable ? onMouseMove : () => undefined}\r\n          onMouseUp={mouseEnable ? onSwipeEnd : () => undefined}\r\n          onTouchStart={touchEnable ? onSwipeStart : () => undefined}\r\n          onTouchMove={touchEnable ? onSwipeMove : () => undefined}\r\n          onTouchEnd={touchEnable ? onSwipeEnd : () => undefined}\r\n        >\r\n          {children}\r\n        </div>\r\n      </Fragment>\r\n    );\r\n  }\r\n);\r\n\r\nexport default ActionSheet;\r\n"],"names":[],"mappings":"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"}